import PySimpleGUI as sg
import pandas as pd

# Sample DataFrame
data = {
    'staffname': ['Alice', 'Bob', 'Charlie', 'Alice', 'Charlie'],
    'staffid': [None, '123', None, None, None]
}
df = pd.DataFrame(data)

# Convert DataFrame to a list of lists for table display
table_data = df.values.tolist()

# Define table headings
headings = ['Staff Name', 'Staff ID']

# Define layout with a table, text input for copying staff name, and input for updating staff ID
layout = [
    [sg.Table(values=table_data, headings=headings, key='-TABLE-', auto_size_columns=True, justification='right',
              enable_events=True, vertical_scroll_only=True, size=(40, 10))],
    [sg.Text('Selected staff name:', size=(20, 1)), sg.InputText('', key='-SELECTED_NAME-', readonly=True)],
    [sg.Text('Update staff ID:', size=(20, 1)), sg.InputText('', key='-NEW_ID-')],
    [sg.Button('Update Staff ID')]
]

# Create the window
window = sg.Window("Staff Information", layout)

while True:
    event, values = window.read()

    if event == sg.WINDOW_CLOSED:
        break

    # When a row is selected in the table
    if event == '-TABLE-':
        selected_row_index = values['-TABLE-'][0]  # Get the index of the selected row
        selected_staffname = df.iloc[selected_row_index]['staffname']
        current_staffid = df.iloc[selected_row_index]['staffid']

        # Display selected staff name and current staff ID
        window['-SELECTED_NAME-'].update(selected_staffname)
        window['-NEW_ID-'].update(current_staffid if current_staffid is not None else "")

    # When the user clicks "Update Staff ID"
    elif event == 'Update Staff ID':
        new_staffid = values['-NEW_ID-']
        selected_staffname = values['-SELECTED_NAME-']

        # Update the staff ID for the selected staff name in the DataFrame
        df.loc[df['staffname'] == selected_staffname, 'staffid'] = new_staffid
        
        # Refresh table data
        table_data = df.values.tolist()
        window['-TABLE-'].update(values=table_data)

window.close()
