import PySimpleGUI as sg
import pandas as pd

# Sample DataFrame with duplicate staffnames
data = {
    'staffname': ['Alice', 'Bob', 'Charlie', 'Alice', 'Charlie'],
    'staffid': [None, '123', None, None, None]
}
df = pd.DataFrame(data)

# Filter rows where 'staffid' is null and get unique staffnames
null_staffid_rows = df[df['staffid'].isnull()]
unique_staffnames = null_staffid_rows['staffname'].unique()

# Prepare the layout dynamically for each unique missing staffid
layout = []
for staffname in unique_staffnames:
    layout.append([sg.Text(f"Enter Staff ID for {staffname}:"), sg.InputText(key=staffname)])

layout.append([sg.Button('OK')])

# Show the popup with input fields for each unique staffname
window = sg.Window("Enter Missing Staff IDs", layout)
event, values = window.read()
window.close()

# Update the DataFrame with the entered staff IDs
if event == 'OK':
    for staffname, staffid in values.items():
        if staffid:  # Only update if there's a value entered
            # Update all rows with this staffname in the DataFrame
            df.loc[df['staffname'] == staffname, 'staffid'] = staffid

# Show the updated DataFrame
print(df)
